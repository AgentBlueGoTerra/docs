<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Writing the Contract | Terra Docs</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/7420256/6416592/css/fonts.css">
    <link rel="stylesheet" type="text/css" href="https://terra.money/static/fonts/jetbrainsMono.css?updated=190220">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,500,700&amp;display=swap">
    <link rel="icon" type="image/png" href="/img/favicon.png">
    <meta name="description" content="Terra is the decentralized financial infrastructure powering the innovation of money. Terra provides the foundational building blocks for a new digital economy with its stablecoin protocol, oracle system, smart contracts, and plan for mass-user adoption.">
    <link rel="preload" href="/assets/css/0.styles.f13d3408.css" as="style"><link rel="preload" href="/assets/js/app.7d6944e6.js" as="script"><link rel="preload" href="/assets/js/3.c619ea57.js" as="script"><link rel="preload" href="/assets/js/11.1990e9a0.js" as="script"><link rel="prefetch" href="/assets/js/10.1f1ed6d9.js"><link rel="prefetch" href="/assets/js/12.9e056092.js"><link rel="prefetch" href="/assets/js/13.5547d822.js"><link rel="prefetch" href="/assets/js/14.de810803.js"><link rel="prefetch" href="/assets/js/15.ef841096.js"><link rel="prefetch" href="/assets/js/16.9e6f060b.js"><link rel="prefetch" href="/assets/js/17.32a4c9ec.js"><link rel="prefetch" href="/assets/js/18.cb15b5ca.js"><link rel="prefetch" href="/assets/js/19.533621e4.js"><link rel="prefetch" href="/assets/js/20.0ac01542.js"><link rel="prefetch" href="/assets/js/21.72fcd4ec.js"><link rel="prefetch" href="/assets/js/22.eabc6df9.js"><link rel="prefetch" href="/assets/js/23.120501dc.js"><link rel="prefetch" href="/assets/js/24.bf0b4064.js"><link rel="prefetch" href="/assets/js/25.6a233e11.js"><link rel="prefetch" href="/assets/js/26.6bb7af3e.js"><link rel="prefetch" href="/assets/js/27.890975d2.js"><link rel="prefetch" href="/assets/js/28.26cdc928.js"><link rel="prefetch" href="/assets/js/29.58d12201.js"><link rel="prefetch" href="/assets/js/30.23dc9449.js"><link rel="prefetch" href="/assets/js/31.e5715917.js"><link rel="prefetch" href="/assets/js/32.921b1fba.js"><link rel="prefetch" href="/assets/js/33.f7a15a76.js"><link rel="prefetch" href="/assets/js/34.7242c531.js"><link rel="prefetch" href="/assets/js/35.e976a0bf.js"><link rel="prefetch" href="/assets/js/36.499642e9.js"><link rel="prefetch" href="/assets/js/37.11676a14.js"><link rel="prefetch" href="/assets/js/38.ee746feb.js"><link rel="prefetch" href="/assets/js/39.9a5c925e.js"><link rel="prefetch" href="/assets/js/4.904f60d4.js"><link rel="prefetch" href="/assets/js/40.136b37d9.js"><link rel="prefetch" href="/assets/js/41.7d9f7cab.js"><link rel="prefetch" href="/assets/js/42.aaf75584.js"><link rel="prefetch" href="/assets/js/43.6e5dfc8e.js"><link rel="prefetch" href="/assets/js/44.15faa9d2.js"><link rel="prefetch" href="/assets/js/45.856a0895.js"><link rel="prefetch" href="/assets/js/46.82252578.js"><link rel="prefetch" href="/assets/js/47.e27698f4.js"><link rel="prefetch" href="/assets/js/48.4cf6051f.js"><link rel="prefetch" href="/assets/js/49.a4b5f0bd.js"><link rel="prefetch" href="/assets/js/5.34f5657c.js"><link rel="prefetch" href="/assets/js/50.985729e8.js"><link rel="prefetch" href="/assets/js/51.573d8295.js"><link rel="prefetch" href="/assets/js/52.2598f312.js"><link rel="prefetch" href="/assets/js/53.bda55e3c.js"><link rel="prefetch" href="/assets/js/54.34e30475.js"><link rel="prefetch" href="/assets/js/55.7caf129d.js"><link rel="prefetch" href="/assets/js/56.55678263.js"><link rel="prefetch" href="/assets/js/57.7e9f4f15.js"><link rel="prefetch" href="/assets/js/58.0fb8c5b3.js"><link rel="prefetch" href="/assets/js/59.4ae80480.js"><link rel="prefetch" href="/assets/js/6.b4f96f88.js"><link rel="prefetch" href="/assets/js/60.465d6486.js"><link rel="prefetch" href="/assets/js/7.345f9a8d.js"><link rel="prefetch" href="/assets/js/8.a634bf07.js"><link rel="prefetch" href="/assets/js/9.7129aa59.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.eec9cc92.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f13d3408.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"></div> <a href="/" class="home-link router-link-active"><img src="/img/docs_logo.svg" alt="Terra Docs" class="logo"> <span class="site-name can-hide">Terra Docs</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Docs</a></div><div class="nav-item"><a href="/dapps/" class="nav-link router-link-active">Contracts</a></div><div class="nav-item"><a href="/validator/" class="nav-link">Validators</a></div><div class="nav-item"><a href="/dev/" class="nav-link">Core</a></div><div class="nav-item"><a href="https://github.com/terra-project/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form></div></header> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Docs</a></div><div class="nav-item"><a href="/dapps/" class="nav-link router-link-active">Contracts</a></div><div class="nav-item"><a href="/validator/" class="nav-link">Validators</a></div><div class="nav-item"><a href="/dev/" class="nav-link">Core</a></div><div class="nav-item"><a href="https://github.com/terra-project/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav>  <ul class="sidebar-links"><li><a href="/dapps/" aria-current="page" class="sidebar-link">dApp Platform</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorial</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dapps/tutorial/" aria-current="page" class="sidebar-link">Getting Started</a></li><li><a href="/dapps/tutorial/setup.html" class="sidebar-link">Environment Setup</a></li><li><a href="/dapps/tutorial/implementation.html" aria-current="page" class="active sidebar-link">Writing the Contract</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#start-with-a-template" class="sidebar-link">Start with a template</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#or-just-follow-along" class="sidebar-link">or just follow along</a></li></ul></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#contract-state" class="sidebar-link">Contract State</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#initmsg" class="sidebar-link">InitMsg</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#example" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#message-definition" class="sidebar-link">Message Definition</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#logic" class="sidebar-link">Logic</a></li></ul></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#handlemsg" class="sidebar-link">HandleMsg</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#example-2" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#message-definition-2" class="sidebar-link">Message Definition</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#logic-2" class="sidebar-link">Logic</a></li></ul></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#querymsg" class="sidebar-link">QueryMsg</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#example-3" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#message-definition-3" class="sidebar-link">Message Definition</a></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#logic-3" class="sidebar-link">Logic</a></li></ul></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#building-the-contract" class="sidebar-link">Building the Contract</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#optimizing-your-build" class="sidebar-link">Optimizing your build</a></li></ul></li><li class="sidebar-sub-header"><a href="/dapps/tutorial/implementation.html#schemas" class="sidebar-link">Schemas</a></li></ul></li><li><a href="/dapps/tutorial/interacting.html" class="sidebar-link">Interacting with the Contract</a></li></ul></section></li></ul>  <div class="sidebar_footer"><a href="https://jigu.terra.money/" target="_blank"><div class="image"><img src="/img/jigu_logo.svg"></div> <div class="name"><div><b>Jigu</b> Python SDK
          <i class="material-icons">transit_enterexit</i></div></div></a> <a href="https://terra-project.github.io/terra.js/" target="_blank"><div class="image"><img src="/img/terra_js.svg"></div> <div class="name"><div><b>Terra.js</b> JS SDK
          <i class="material-icons">transit_enterexit</i></div></div></a></div></aside> <main class="page"> <nav id="breadcrumb" class="breadcrumb-container" data-v-5c2bdde3><a href="/" class="breadcrumb router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Terra Docs</span></a><a href="/dapps/" class="breadcrumb router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>dApp Platform</span></a><a href="/dapps/tutorial/" class="breadcrumb router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Getting Started</span></a><a href="/dapps/tutorial/implementation.html" aria-current="page" class="breadcrumb router-link-exact-active router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Writing the Contract</span></a></nav> <div class="theme-default-content content__default"><h1 id="writing-the-contract"><a href="#writing-the-contract" class="header-anchor">#</a> Writing the Contract</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You can find the complete contract <a href="https://github.com/terra-project/my-terra-token" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <p>A smart contract can be considered an instance of a singleton object whose internal state is persisted on the blockchain. Users can trigger state changes through sending it JSON messages, and users can also query its state through sending a request formatted as a JSON message. These messages are different than Terra blockchain messages such as <code>MsgSend</code> and <code>MsgSwap</code>.</p> <p>As a smart contract writer, your job is to define 3 functions that define your smart contract's interface:</p> <ul><li><code>init()</code>: a constructor which is called during contract instantiation to provide initial state</li> <li><code>handle()</code>: gets called when a user wants to invoke a method on the smart contract</li> <li><code>query()</code>: gets called when a user wants to get data out of a smart contract</li></ul> <p>In this section, we'll define our expected messages alongside their implementation.</p> <h2 id="start-with-a-template"><a href="#start-with-a-template" class="header-anchor">#</a> Start with a template</h2> <p>In your working directory, you'll want to use <code>cargo-generate</code> to start your smart contract with the recommended folder structure and build options:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>cargo generate --git https://github.com/CosmWasm/cosmwasm-template.git --name my-terra-token
<span class="token builtin class-name">cd</span> my-terra-token
</code></pre></div><p>This helps get you started by prepopulating the requisite boilerplate for a smart contract. You'll find in the <code>src/lib.rs</code> file that the standard CosmWasm entrypoints <code>init()</code>, <code>handle()</code>, and <code>query()</code> are properly exposed and hooked up.</p> <h3 id="or-just-follow-along"><a href="#or-just-follow-along" class="header-anchor">#</a> or just follow along</h3> <p>The following is the complete example of the contract, if you want to read a full implementation.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">git</span> clone https://github.com/terra-project/my-terra-token
<span class="token builtin class-name">cd</span> my-terra-token
</code></pre></div><h2 id="contract-state"><a href="#contract-state" class="header-anchor">#</a> Contract State</h2> <p>For our example smart contract, we will need:</p> <ul><li><code>Config</code>: a <code>struct</code> holding our contract configuration:
<ul><li><code>String</code> token name</li> <li><code>String</code> token symbol</li> <li><code>CanonicalAddr</code> contract owner (creator)</li></ul></li> <li><code>balances</code>: a mapping from <code>CanonicalAddr</code> account addresses to <code>Uint128</code> balance</li></ul> <p>Terra smart contracts have the ability to keep persistent state across different executions through a bytes-based key-value store.
Working at such a low level, you will need to be aware of how the data structures you need are stored as bytes -- including things you might take for granted in other environments, such as numbers. In order to save the data above, we need to find a way that they can be encoded (serialized) into raw bytes, and how those bytes can be converted back into data types that your contract logic can understand.</p> <p>Fortunately, the CosmWasm team has provided has created the <a href="https://github.com/CosmWasm/cosmwasm/tree/master/packages/storage" target="_blank" rel="noopener noreferrer">cosmwasm_storage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> crate, which provides several higher-level abstractions that enable us to work with a &quot;singleton&quot; and &quot;bucket&quot;, which provide us automatic serialization and deserialization.</p> <p>We'll use the singleton to store our <code>Config</code> struct, as it will be a simple data structure that exists at a single key. For our <code>balances</code>, we can use a bucket, which is a key-value store interface to implement a map. The bucket will store entries of type <code>Uint128</code>, a data type with serialization and deserialization that wraps a native Rust <code>u128</code>.</p> <p>Clear our <code>src/state.rs</code> and make the following changes:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/state.rs</span>

<span class="token keyword">use</span> schemars<span class="token punctuation">::</span>JsonSchema<span class="token punctuation">;</span>
<span class="token keyword">use</span> serde<span class="token punctuation">::</span><span class="token punctuation">{</span>Deserialize<span class="token punctuation">,</span> Serialize<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> cosmwasm_std<span class="token punctuation">::</span><span class="token punctuation">{</span>CanonicalAddr<span class="token punctuation">,</span> StdResult<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Uint128<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> cosmwasm_storage<span class="token punctuation">::</span><span class="token punctuation">{</span>Bucket<span class="token punctuation">,</span> ReadonlyBucket<span class="token punctuation">,</span> ReadonlySingleton<span class="token punctuation">,</span> Singleton<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">static</span> CONFIG_KEY<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>u8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">b&quot;config&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">static</span> BALANCE_KEY<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>u8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">b&quot;balance&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>We first define the keys for our <code>Config</code> and <code>balance</code> data requirements. <code>balance</code> will be used as a prefix key to implement a mapping, using <code>address</code> as a subkey.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> Config <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> symbol<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> owner<span class="token punctuation">:</span> CanonicalAddr<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Next, we define our <code>Config</code> struct, which will hold <code>name</code>, <code>symbol</code>, and <code>owner</code>. We use the <code>derive</code> attribute to auto-implement some useful traits:</p> <ul><li><code>Serialize</code>: provides serialization</li> <li><code>Deserialize</code>: provides deserialization</li> <li><code>Clone</code>: makes our struct copyable</li> <li><code>Debug</code>: enables our struct to be printed to string</li> <li><code>PartialEq</code>: gives us eqality comparison</li> <li><code>JsonSchema</code>: auto-generates a JSON schema for us</li></ul> <p>Something to note here is that <code>CanonicalAddr</code> refers to a Terra address's native decoded Bech32 form in bytes. Its counterpart is the <code>HumanAddr</code>, which represents a human-readable address prefixed with <code>terra...</code>.</p> <p>When working with storage of account addresses for the contract, prefer to use the <code>CanonicalAddr</code>. When sending back data to the user, or expecting using input prefer the <code>HumanAddr</code> (and convert it to <code>CanonicalAddr</code> to work with it inside your contract).</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> config_get<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token operator">&gt;</span><span class="token punctuation">(</span>storage<span class="token punctuation">:</span> <span class="token operator">&amp;</span>S<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>Config<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    ReadonlySingleton<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>storage<span class="token punctuation">,</span> CONFIG_KEY<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> config_set<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token operator">&gt;</span><span class="token punctuation">(</span>storage<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> S<span class="token punctuation">,</span> config<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Config<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    Singleton<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>storage<span class="token punctuation">,</span> CONFIG_KEY<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We define a simple <code>get</code> and <code>set</code> function for our <code>Config</code> struct, using a singleton to store the data.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> balance_get<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token operator">&gt;</span><span class="token punctuation">(</span>storage<span class="token punctuation">:</span> <span class="token operator">&amp;</span>S<span class="token punctuation">,</span> address<span class="token punctuation">:</span> <span class="token operator">&amp;</span>CanonicalAddr<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> Uint128 <span class="token punctuation">{</span>
    <span class="token keyword">match</span> ReadonlyBucket<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>BALANCE_KEY<span class="token punctuation">,</span> storage<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">may_load</span><span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">as_slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token function">Some</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> amount<span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> Uint128<span class="token punctuation">::</span><span class="token function">zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> balance_set<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    storage<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> S<span class="token punctuation">,</span>
    address<span class="token punctuation">:</span> <span class="token operator">&amp;</span>CanonicalAddr<span class="token punctuation">,</span>
    amount<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Uint128<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    Bucket<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>BALANCE_KEY<span class="token punctuation">,</span> storage<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">as_slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> amount<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We define a simple <code>get</code> and <code>set</code> function for our <code>balance</code> mapping. Notice that for our <code>get</code>, if we encounter an error such as the address does not exist, we report back a <code>Uint128::zero()</code>. This sets all the default balances for addresses not yet assigned to be zero.</p> <h2 id="initmsg"><a href="#initmsg" class="header-anchor">#</a> InitMsg</h2> <p>The <code>InitMsg</code> is provided when a user creates a contract on the blockchain through a <code>MsgInstantiateContract</code>. This provides the contract with its configuration as well as its initial state.</p> <p>On the Terra blockchain, the uploading of a contract's code and the instantiation of a contract is regarded as separate events, unlike with Ethereum. This is to allow a small set of vetted contract archetypes to exist with multiple instances, each sharing the same base code but configured with different parameters (imagine one canonical ERC20, and multiple tokens that use its code).</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <p>For our contract, we will expect a contract creator to supply the relevant information in a JSON message such as the following:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MyTerraToken&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;symbol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MTT&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;initial_balances&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terra...&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10000&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terra...&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5000&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="message-definition"><a href="#message-definition" class="header-anchor">#</a> Message Definition</h3> <p>Open up <code>src/msg.rs</code>, and clear and fill in the following:</p> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>Note that we have to use <code>Uint128</code> instead of <code>u128</code>, which is a wrapped representation of an unsigned 128-bit integer provided to us by the CosmWasm API. This serializes and deserializes with strings behind the scenes.</p></div> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/msg.rs</span>

<span class="token keyword">use</span> schemars<span class="token punctuation">::</span>JsonSchema<span class="token punctuation">;</span>
<span class="token keyword">use</span> serde<span class="token punctuation">::</span><span class="token punctuation">{</span>Deserialize<span class="token punctuation">,</span> Serialize<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> cosmwasm_std<span class="token punctuation">::</span><span class="token punctuation">{</span>HumanAddr<span class="token punctuation">,</span> Uint128<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> InitialBalance <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> address<span class="token punctuation">:</span> HumanAddr<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> amount<span class="token punctuation">:</span> Uint128<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, JsonSchema)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> InitMsg <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> symbol<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> initial_balances<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>InitialBalance<span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="logic"><a href="#logic" class="header-anchor">#</a> Logic</h3> <p>Here we define our first entry-point, the <code>init()</code>, or where the contract is instantiated and passed its <code>InitMsg</code>. We need to set up all the initial state:</p> <ol><li>the constants that define the contract's configuration (name, symbol)</li> <li>the initial balances of all the accounts</li></ol> <p>Open up <code>src/contract.rs</code>, clear the file, and add the following:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/contract.rs</span>

<span class="token keyword">use</span> cosmwasm_std<span class="token punctuation">::</span><span class="token punctuation">{</span>
    generic_err<span class="token punctuation">,</span> log<span class="token punctuation">,</span> to_binary<span class="token punctuation">,</span> Api<span class="token punctuation">,</span> Binary<span class="token punctuation">,</span> Env<span class="token punctuation">,</span> Extern<span class="token punctuation">,</span> HandleResponse<span class="token punctuation">,</span> HumanAddr<span class="token punctuation">,</span> InitResponse<span class="token punctuation">,</span>
    Querier<span class="token punctuation">,</span> StdResult<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Uint128<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>msg<span class="token punctuation">::</span><span class="token punctuation">{</span>BalanceResponse<span class="token punctuation">,</span> ConfigResponse<span class="token punctuation">,</span> HandleMsg<span class="token punctuation">,</span> InitMsg<span class="token punctuation">,</span> QueryMsg<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>state<span class="token punctuation">::</span><span class="token punctuation">{</span>balance_get<span class="token punctuation">,</span> balance_set<span class="token punctuation">,</span> config_get<span class="token punctuation">,</span> config_set<span class="token punctuation">,</span> Config<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> init<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token punctuation">,</span> A<span class="token punctuation">:</span> Api<span class="token punctuation">,</span> Q<span class="token punctuation">:</span> Querier<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    deps<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Extern<span class="token operator">&lt;</span>S<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Q<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    env<span class="token punctuation">:</span> Env<span class="token punctuation">,</span>
    msg<span class="token punctuation">:</span> InitMsg<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>InitResponse<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Initial balances</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> msg<span class="token punctuation">.</span>initial_balances <span class="token punctuation">{</span>
        <span class="token keyword">let</span> address <span class="token operator">=</span> deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">canonical_address</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>row<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
        <span class="token function">balance_set</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> <span class="token operator">&amp;</span>address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">.</span>amount<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">config_set</span><span class="token punctuation">(</span>
        <span class="token operator">&amp;</span><span class="token keyword">mut</span> deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span>
        <span class="token operator">&amp;</span>Config <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> msg<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            symbol<span class="token punctuation">:</span> msg<span class="token punctuation">.</span>symbol<span class="token punctuation">,</span>
            owner<span class="token punctuation">:</span> env<span class="token punctuation">.</span>message<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token function">Ok</span><span class="token punctuation">(</span>InitResponse<span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="handlemsg"><a href="#handlemsg" class="header-anchor">#</a> HandleMsg</h2> <p>The <code>HandleMsg</code> is a JSON message passed to the <code>handle()</code> function through a <code>MsgExecuteContract</code>. Unlike the <code>InitMsg</code>, the <code>HandleMsg</code> can exist as several different types of messages, to account for the different types of functions that a smart contract can expose to a user. The <code>handle()</code> function demultiplexes these different types of messages to its appropriate message handler logic.</p> <h3 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h3> <p>For our simple token example, we want to support the following functions:</p> <h4 id="transfer"><a href="#transfer" class="header-anchor">#</a> Transfer</h4> <p>A user can <em>transfer</em> tokens to another account, from its own balance.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;transfer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;recipient&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terra...&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="burn"><a href="#burn" class="header-anchor">#</a> Burn</h4> <p>A user can <em>burn</em> their tokens, permanently removing them from the supply.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;burn&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="message-definition-2"><a href="#message-definition-2" class="header-anchor">#</a> Message Definition</h3> <p>As for our <code>HandleMsg</code>, we will use an <code>enum</code> to multiplex over the different types of messages that our contract can understand. The <code>serde</code> attribute rewrites our attribute keys in snake case and lower case, so we'll have <code>transfer</code> and <code>burn</code> instead of <code>Transfer</code> and <code>Burn</code> when serializing and deserializing across JSON.</p> <p>Add the following to <code>src/msg.rs</code>:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/msg.rs</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, JsonSchema)]</span>
<span class="token attribute attr-name">#[serde(rename_all = &quot;snake_case&quot;)]</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> HandleMsg <span class="token punctuation">{</span>
  Transfer <span class="token punctuation">{</span>
    recipient<span class="token punctuation">:</span> HumanAddr<span class="token punctuation">,</span>
    amount<span class="token punctuation">:</span> Uint128<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Burn <span class="token punctuation">{</span>
    amount<span class="token punctuation">:</span> Uint128<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="logic-2"><a href="#logic-2" class="header-anchor">#</a> Logic</h3> <p>Add the following to <code>src/contract.rs</code>:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/contract.rs</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> handle<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token punctuation">,</span> A<span class="token punctuation">:</span> Api<span class="token punctuation">,</span> Q<span class="token punctuation">:</span> Querier<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    deps<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Extern<span class="token operator">&lt;</span>S<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Q<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    env<span class="token punctuation">:</span> Env<span class="token punctuation">,</span>
    msg<span class="token punctuation">:</span> HandleMsg<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>HandleResponse<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>
        HandleMsg<span class="token punctuation">::</span>Transfer <span class="token punctuation">{</span> recipient<span class="token punctuation">,</span> amount <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token function">try_transfer</span><span class="token punctuation">(</span>deps<span class="token punctuation">,</span> env<span class="token punctuation">,</span> <span class="token operator">&amp;</span>recipient<span class="token punctuation">,</span> <span class="token operator">&amp;</span>amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
        HandleMsg<span class="token punctuation">::</span>Burn <span class="token punctuation">{</span> amount <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token function">try_burn</span><span class="token punctuation">(</span>deps<span class="token punctuation">,</span> env<span class="token punctuation">,</span> <span class="token operator">&amp;</span>amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is our <code>handle()</code> method, which matches our message against different types of <code>HandleMsg</code>. This then dispatches either a <code>try_transfer()</code> or a <code>try_burn()</code> call, depending on the message received.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> try_transfer<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token punctuation">,</span> A<span class="token punctuation">:</span> Api<span class="token punctuation">,</span> Q<span class="token punctuation">:</span> Querier<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    deps<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Extern<span class="token operator">&lt;</span>S<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Q<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    env<span class="token punctuation">:</span> Env<span class="token punctuation">,</span>
    recipient<span class="token punctuation">:</span> <span class="token operator">&amp;</span>HumanAddr<span class="token punctuation">,</span>
    amount<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Uint128<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>HandleResponse<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// canonical address</span>
    <span class="token keyword">let</span> sender_address <span class="token operator">=</span> <span class="token operator">&amp;</span>env<span class="token punctuation">.</span>message<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token keyword">let</span> recipient_address <span class="token operator">=</span> <span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">canonical_address</span><span class="token punctuation">(</span>recipient<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token comment">// check that sender's funds covers</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> sender_balance <span class="token operator">=</span> <span class="token function">balance_get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> sender_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> sender_balance <span class="token operator">&lt;</span> <span class="token operator">*</span>amount <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span><span class="token function">generic_err</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Insufficient funds to send: balance={}, required={}&quot;</span><span class="token punctuation">,</span>
            sender_balance<span class="token punctuation">,</span> amount
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// update balances</span>
    sender_balance <span class="token operator">=</span> <span class="token punctuation">(</span>sender_balance <span class="token operator">-</span> <span class="token operator">*</span>amount<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> recipient_balance <span class="token operator">=</span> <span class="token function">balance_get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> recipient_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    recipient_balance <span class="token operator">=</span> recipient_balance <span class="token operator">+</span> <span class="token operator">*</span>amount<span class="token punctuation">;</span>

    <span class="token function">balance_set</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> sender_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sender_balance<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token function">balance_set</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> recipient_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>recipient_balance<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token comment">// report what happened in the log</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> HandleResponse <span class="token punctuation">{</span>
        messages<span class="token punctuation">:</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        log<span class="token punctuation">:</span> <span class="token function">vec!</span><span class="token punctuation">[</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;send&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;sender&quot;</span><span class="token punctuation">,</span> deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">human_address</span><span class="token punctuation">(</span>sender_address<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;recipient&quot;</span><span class="token punctuation">,</span> recipient<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> None<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">Ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It is quite straightforward to follow the logic of <code>try_transfer()</code>. In the first part, we need to ensure that the sender's token balance is not smaller than the amount that they wish to send. After, we need to calculate the new balances of the sender and the recipient, apply them with <code>balance_set()</code>. Finally, we need to create a <code>HandleResponse</code> which will tell the blockchain how to wrap up our contract execution:</p> <ul><li><code>messages</code>: a list of messages to emit like <code>MsgSend</code>, <code>MsgSwap</code>, etc. This is where smart contracts can influence other modules on the Terra blockchain.</li> <li><code>log</code>: a list of key-value pairs to define emitted SDK events that can be subscribed to by clients and parsed by block explorers and applications to report important events or state changes that occured during the execution.</li> <li><code>data</code>: additional data that the contract can record</li></ul> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/contract.rs</span>

<span class="token keyword">fn</span> try_burn<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token punctuation">,</span> A<span class="token punctuation">:</span> Api<span class="token punctuation">,</span> Q<span class="token punctuation">:</span> Querier<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    deps<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Extern<span class="token operator">&lt;</span>S<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Q<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    env<span class="token punctuation">:</span> Env<span class="token punctuation">,</span>
    amount<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Uint128<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>HandleResponse<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// canonical address</span>
    <span class="token keyword">let</span> sender_address <span class="token operator">=</span> <span class="token operator">&amp;</span>env<span class="token punctuation">.</span>message<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> sender_balance <span class="token operator">=</span> <span class="token function">balance_get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> sender_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> sender_balance <span class="token operator">&lt;</span> <span class="token operator">*</span>amount <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span><span class="token function">generic_err</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Insufficient funds to burn: balance={}, required={}&quot;</span><span class="token punctuation">,</span>
            sender_balance<span class="token punctuation">,</span> amount
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// update balance</span>
    sender_balance <span class="token operator">=</span> <span class="token punctuation">(</span>sender_balance <span class="token operator">-</span> <span class="token operator">*</span>amount<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token function">balance_set</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> sender_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sender_balance<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> res <span class="token operator">=</span> HandleResponse <span class="token punctuation">{</span>
        messages<span class="token punctuation">:</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        log<span class="token punctuation">:</span> <span class="token function">vec!</span><span class="token punctuation">[</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;burn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;sender&quot;</span><span class="token punctuation">,</span> deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">human_address</span><span class="token punctuation">(</span>sender_address<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> None<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">Ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The logic for burning is very similar to sending; instead of sending to a recipient and crediting that recipient with the corresponding amount, the sender simply loses the coins.</p> <h2 id="querymsg"><a href="#querymsg" class="header-anchor">#</a> QueryMsg</h2> <h3 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h3> <p>Our contract will just support 2 types of query messages:</p> <h4 id="balance"><a href="#balance" class="header-anchor">#</a> Balance</h4> <p>The request:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terra...&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which should return:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="config"><a href="#config" class="header-anchor">#</a> Config</h4> <p>The request:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which should return:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;coin-name&gt;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;symbol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;coin-symbol&gt;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terra...&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="message-definition-3"><a href="#message-definition-3" class="header-anchor">#</a> Message Definition</h3> <p>To support queries against our contract for data, we'll have to define both a <code>QueryMsg</code> format (which represents requests), as well as provide the structure of the query's output -- <code>BalanceResponse</code> and <code>ConfigResponse</code> in this case. We must do this because <code>query()</code> will send back information to the user through JSON in a structure and we must make the shape of our response known.</p> <p>Add the following to your <code>src/msg.rs</code>:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/msg.rs</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]</span>
<span class="token attribute attr-name">#[serde(rename_all = &quot;snake_case&quot;)]</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> QueryMsg <span class="token punctuation">{</span>
    Balance <span class="token punctuation">{</span> address<span class="token punctuation">:</span> HumanAddr <span class="token punctuation">}</span><span class="token punctuation">,</span>
    Config <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> BalanceResponse <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> balance<span class="token punctuation">:</span> Uint128<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> ConfigResponse <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> symbol<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">pub</span> owner<span class="token punctuation">:</span> HumanAddr<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="logic-3"><a href="#logic-3" class="header-anchor">#</a> Logic</h3> <p>The logic for <code>query()</code> should be similar to that of <code>handle()</code>, except that, since <code>query()</code> is called without the end-user making a transaction, there is no information, we omit the <code>env</code> argument.</p> <p>Add the following to your <code>src/contract.rs</code>:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// src/contract.rs</span>

<span class="token keyword">pub</span> <span class="token keyword">fn</span> query<span class="token operator">&lt;</span>S<span class="token punctuation">:</span> Storage<span class="token punctuation">,</span> A<span class="token punctuation">:</span> Api<span class="token punctuation">,</span> Q<span class="token punctuation">:</span> Querier<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    deps<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Extern<span class="token operator">&lt;</span>S<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Q<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    msg<span class="token punctuation">:</span> QueryMsg<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> StdResult<span class="token operator">&lt;</span>Binary<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>
        QueryMsg<span class="token punctuation">::</span>Balance <span class="token punctuation">{</span> address <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> address <span class="token operator">=</span> deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">canonical_address</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>address<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> balance <span class="token operator">=</span> <span class="token function">balance_get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>storage<span class="token punctuation">,</span> <span class="token operator">&amp;</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> out <span class="token operator">=</span> <span class="token function">to_binary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>BalanceResponse <span class="token punctuation">{</span> balance <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        QueryMsg<span class="token punctuation">::</span>Config <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token function">config_get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>deps<span class="token punctuation">.</span>storage<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> out <span class="token operator">=</span> <span class="token function">to_binary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ConfigResponse <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span> config<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                symbol<span class="token punctuation">:</span> config<span class="token punctuation">.</span>symbol<span class="token punctuation">,</span>
                owner<span class="token punctuation">:</span> deps<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">human_address</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>config<span class="token punctuation">.</span>owner<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="building-the-contract"><a href="#building-the-contract" class="header-anchor">#</a> Building the Contract</h2> <p>To build your contract, run the following command. This will check for any preliminary errors before optimizing.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>cargo wasm
</code></pre></div><h3 id="optimizing-your-build"><a href="#optimizing-your-build" class="header-anchor">#</a> Optimizing your build</h3> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>You will need <a href="https://www.docker.com" target="_blank" rel="noopener noreferrer">Docker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> installed to run this command.</p></div> <p>You will need to make sure the output WASM binary is as small as possible in order to minimize fees and stay under the size limit for the blockchain. Run the following command in the root directory of your Rust smart contract's project folder.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker run --rm -v <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>:/code <span class="token punctuation">\</span>
  --mount <span class="token assign-left variable">type</span><span class="token operator">=</span>volume,source<span class="token operator">=</span><span class="token string">&quot;$(basename &quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span><span class="token punctuation">)</span>_cache&quot;,target<span class="token operator">=</span>/code/target <span class="token punctuation">\</span>
  --mount <span class="token assign-left variable">type</span><span class="token operator">=</span>volume,source<span class="token operator">=</span>registry_cache,target<span class="token operator">=</span>/usr/local/cargo/registry <span class="token punctuation">\</span>
  cosmwasm/rust-optimizer:0.8.0
</code></pre></div><p>This will result in an optimized <code>contract.wasm</code> being produced in your working directory.</p> <h2 id="schemas"><a href="#schemas" class="header-anchor">#</a> Schemas</h2> <p>In order to make use of JSON-schema auto-generation, we should register each of the data structures that we need schemas for. Open up <code>examples/schema.rs</code> and insert the following:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> std<span class="token punctuation">::</span>env<span class="token punctuation">::</span>current_dir<span class="token punctuation">;</span>
<span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>create_dir_all<span class="token punctuation">;</span>

<span class="token keyword">use</span> cosmwasm_schema<span class="token punctuation">::</span><span class="token punctuation">{</span>export_schema<span class="token punctuation">,</span> remove_schemas<span class="token punctuation">,</span> schema_for<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> my_terra_token<span class="token punctuation">::</span>msg<span class="token punctuation">::</span><span class="token punctuation">{</span>BalanceResponse<span class="token punctuation">,</span> ConfigResponse<span class="token punctuation">,</span> HandleMsg<span class="token punctuation">,</span> InitMsg<span class="token punctuation">,</span> QueryMsg<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> my_terra_token<span class="token punctuation">::</span>state<span class="token punctuation">::</span>Config<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> out_dir <span class="token operator">=</span> <span class="token function">current_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out_dir<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;schema&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">create_dir_all</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">remove_schemas</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>InitMsg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>HandleMsg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>QueryMsg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>Config<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>BalanceResponse<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">export_schema</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">schema_for!</span><span class="token punctuation">(</span>ConfigResponse<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can then build the schemas with:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>cargo schema
</code></pre></div><p>Your newly generated schemas should be visible in your <code>schema/</code> directory. The following is an example of <code>schema/query_msg.json</code>.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;$schema&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;QueryMsg&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;anyOf&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;$ref&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#/definitions/HumanAddr&quot;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;config&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;definitions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;HumanAddr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can use an online tool such as <a href="https://www.jsonschemavalidator.net/" target="_blank" rel="noopener noreferrer">JSON Schema Validator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to test your input against the generated JSON schema.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/terra-project/docs/edit/master/docs/dapps/tutorial/implementation.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Updated on:</span> <span class="time">7/21/2020, 2:52:25 AM</span></div></footer> <div class="page-nav"><div class="inner"><div class="prev"><a href="/dapps/tutorial/setup.html">Environment Setup</a></div> <div class="next"><a href="/dapps/tutorial/interacting.html">Interacting with the Contract</a></div></div></div>  <div class="footer-container"><div class="company"><div class="copyright">Terraform labs PTE.LTD</div> <div class="subscribe"><div class="subscribe-title">Subscribe to get updates</div> <form action="https://money.us17.list-manage.com/subscribe/post?u=8eca8dc5c91c2e30d69b1463e&id=1447662093" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" novalidate="novalidate" class="validate"><input type="email" value name="EMAIL" id="mce-EMAIL" placeholder="Email address" required="required" class="email">
        real people should not fill this in and expect good things - do not remove this or risk form bot
        signups
        <div aria-hidden="true" style="position: absolute; left: -5000px;"><input type="text" name="b_8eca8dc5c91c2e30d69b1463e_1447662093" tabindex="-1" value></div> <button type="submit">Submit</button></form></div></div> <div class="links-container"><ul class="learn"><li>Learn</li> <li><a href="https://terra.money/Terra_White_paper.pdf" target="_blank">
          White
          Paper
        </a></li> <li><a href="https://docsend.com/view/9mvr5qq" target="_blank">Decks</a></li> <li><a href="https://certik.org/reports/terra.pdf" target="_blank">Security Audit</a></li> <li><a href="https://agora.terra.money/" target="_blank">Agora Discussions</a></li></ul> <ul class="developers"><li>Tools</li> <li><a href="https://station.terra.money/" target="_blank">Terra Station</a></li> <li><a href="https://finder.terra.money/" target="_blank">Terra Finder</a></li> <li><a href="https://status.terra.money/" target="_blank">Status</a></li></ul> <ul class="developers"><li>Luna</li> <li><a href="https://docs.terra.money/luna" target="_blank">What is Luna?</a></li> <li><a href="https://docs.terra.money/integrations.html#exchanges" target="_blank">Exchanges</a></li> <li><a href="https://docs.terra.money/integrations.html#wallets" target="_blank">Wallets</a></li></ul> <ul class="developers"><li>Foundation</li> <li><a href="https://terra.money/about.html" target="_blank">Team</a></li> <li><a href="https://terra.breezy.hr/" target="_blank">Careers</a></li></ul> <ul class="developers"><li>Developers</li> <li><a href="https://github.com/terra-project" target="_blank">Github</a></li> <li><a href="https://docs.terra.money/" target="_blank">Documentation</a></li> <li><a href="https://docs.terra.money/#sdks-for-developers" target="_blank">SDKs</a></li> <li><a href="https://github.com/terra-project/TIPs" target="_blank">TIPs</a></li></ul> <ul class="developers"><li>Validators</li> <li><a href="https://docs.terra.money/validator" target="_blank">Validator Guide</a></li> <li><a href="https://github.com/terra-project/validator-profiles" target="_blank">Profiles</a></li> <li><a href="https://discord.gg/ZHBuKda" target="_blank">Discord Channel</a></li></ul></div> <div class="sns-container"><div class="logos"><a href="https://discord.gg/bYfyhUT" rel="noopener" target="_blank"><img src="https://terra.money/static/assets/images/icon_discord.png" alt="link to Terra discord room"></a> <a href="https://medium.com/terra-money" rel="noopener" target="_blank"><img src="https://terra.money/static/assets/images/icon_medium.png" alt="link to Terra medium"></a> <a href="https://twitter.com/terra_money" rel="noopener" target="_blank"><img src="https://terra.money/static/assets/images/icon_twitter.png" alt="link to Terra twitter"></a> <a href="https://www.youtube.com/channel/UCoV1RXZ9ZBGcuu_PMTTlM0g" rel="noopener" target="_blank"><img src="https://terra.money/static/assets/images/icon_youtube.png" alt="link to Terra youtube"></a> <a href="https://t.me/terra_announcements" rel="noopener" target="_blank"><img src="https://terra.money/static/assets/images/icon_telegram.png" alt="link to Terra telegram room"></a></div> <a href="https://terra.money" target="_blank" class="terramoney">terra.money</a></div></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7d6944e6.js" defer></script><script src="/assets/js/3.c619ea57.js" defer></script><script src="/assets/js/11.1990e9a0.js" defer></script>
  </body>
</html>
